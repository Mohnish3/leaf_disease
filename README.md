# Plant Leaf Disease Detection using Deep Learning

This repository contains a deep learning pipeline for **identifying plant diseases from leaf images**, with a specific focus on **soybean diseases**. The project builds on top of the [custom_d_fine](https://github.com/ArgoHA/custom_d_fine) framework and extends it with customized training, inference, and visualization scripts.

---

## Table of Contents
- [Features](#features)
- [Dataset & Classes](#dataset--classes)
- [Repository Structure](#repository-structure)
- [Installation](#installation)
- [Configuration](#configuration)
- [Usage](#usage)
  - [Batch Image Inference](#batch-image-inference)
  - [Video Inference](#video-inference)
  - [Annotation Plotting](#annotation-plotting)
- [Dependencies](#dependencies)
- [References](#references)

---

## Features
- Detects multiple **soybean leaf diseases** in images.
- Supports **batch inference** for images and **video inference**.
- Generates **annotated images** and **detection summaries**.
- Provides a **plotter utility** to visualize ground truth and predicted annotations.

---

## Dataset & Classes

The model has been trained on a custom soybean leaf disease dataset with the following classes:

| ID | Disease Name                |
|----|-----------------------------|
| 0  | bacterial_blight            |
| 1  | cercospora_leaf_blight      |
| 2  | downey_mildew               |
| 3  | frogeye                     |
| 4  | septoria_leaf_spot          |
| 5  | soybean_rust                |
| 6  | target_spot                 |

The `classes.yaml` file contains the mapping of class IDs to names.

---

## Repository Structure

leaf_disease_d_fine/
│
├─ classes.yaml               # Class definitions for diseases
├─ requirement.txt            # Python dependencies
├─ infer_model.py             # Script for batch image inference
├─ infer_model_video.py       # Script for video inference
├─ plotter.py                 # Visualizes annotations from image-label pairs
├─ models/
│   └─ soya_disease/
│       ├─ model.pt           # Pretrained model weights
│       └─ config.yaml        # Model configuration for training/inference
└─ README.md                  # Project documentation

---


## Installation

# 1. Clone the repository:
git clone <your-repo-url>
cd leaf_disease_d_fine

# 2. Install Python dependencies:
pip install -r requirement.txt

# 3. Make sure the custom_d_fine repository is available:
git clone https://github.com/ArgoHA/custom_d_fine

# 4. Update the PROJECT_ROOT_PATH in scripts to point to your custom_d_fine directory.

# Configuration
Update the following paths in infer_model.py or infer_model_video.py according to your system:
# Path to the root folder containing your images
INPUT_IMAGES_ROOT = 'path/to/images'

# Path for output results
OUTPUT_ROOT = 'outputs_inference_best'

# Model weights and configuration
MODEL_WEIGHTS = './models/soya_disease/model.pt'
TRAINING_CONFIG_FILE = './models/soya_disease/config.yaml'

# Inference parameters
DEVICE = 'cpu'  # or 'cuda:0'
CONFIDENCE_THRESHOLD = 0.6
NMS_IOU_THRESHOLD = 0.5
For video inference:
INPUT_VIDEO_PATH = 'path/to/video.mp4'
OUTPUT_VIDEO_PATH = 'output_video_inference.mp4'
FRAME_SKIP = 2  # Skip frames for faster processing

# Usage
# Batch Image Inference
Run inference on a directory of images:
python infer_model.py
Annotated images are saved in outputs_inference_best/annotated_images/
Detection summary is saved in outputs_inference_best/detection_summary.txt
Optionally save YOLO labels by setting SAVE_YOLO_LABELS = True in the script.

# Annotation Plotting

Annotated images generated by the model:<img width="350" height="270" alt="Bacterial-Blight-in-Soybean-Image1" src="https://github.com/user-attachments/assets/234f286f-28f7-411b-854f-d2f6f960339e" />

![soybean_rust_964](https://github.com/user-attachments/assets/edf9e50e-f426-476c-9017-493abfc31970)

![target_spot_1030](https://github.com/user-attachments/assets/ddead9dd-b012-4739-a7d9-68ee990f2854)

![frogeye_974](https://github.com/user-attachments/assets/0c73b7af-e431-4ec5-a7de-961e9909de6e)

![downey_mildew_158](https://github.com/user-attachments/assets/0f1ffdc3-6aca-429a-8fa0-d9a12ff82933)

![cercospora_leaf_blight_69](https://github.com/user-attachments/assets/f071ecbb-09c0-43a0-a5da-b674762151bd)


# Dependencies
Python 3.8+
PyTorch
OpenCV
numpy, pandas, matplotlib
custom_d_fine
Install all dependencies via:
pip install -r requirement.txt

# References
- [custom_d_fine repository](https://github.com/ArgoHA/custom_d_fine/tree)
1. [Research on soybean leaf disease recognition in natural environment based on improved Yolov8 — Frontiers in Plant Science](https://www.frontiersin.org/journals/plant-science/articles/10.3389/fpls.2025.1523633/full?utm_source=chatgpt.com)
2. [A classification method for soybean leaf diseases based on an improved deep learning network — Scientific Reports (Nature)](https://www.nature.com/articles/s41598-023-46492-3?utm_source=chatgpt.com)
3. [Deep Learning Model for Classifying and Evaluating Soybean Leaf Damage — MDPI](https://www.mdpi.com/1422-0067/25/1/106?utm_source=chatgpt.com)
4. [A recognition method of soybean leaf diseases based on an improved deep learning model — ScienceDirect](https://www.sciencedirect.com/science/article/abs/pii/S1574954123001255?utm_source=chatgpt.com)
5. [Deep learning and computer vision in plant disease detection: a review — Springer](https://link.springer.com/article/10.1007/s10462-024-11100-x?utm_source=chatgpt.com)
6. [Soybean Disease Detection and Segmentation Based on … — JEAI journal](https://journaljeai.com/index.php/JEAI/article/view/2132?utm_source=chatgpt.com)
7. [Survey on Soybean Leaf Disease Detection — IJFANS](https://ijfans.org/uploads/paper/af3eba199c86ccffabe7e510ebe4d6f7.pdf?utm_source=chatgpt.com)
8. [Soybean Leaf Disease Detection Using Machine Learning (GLCM + SVM) — JETIR](https://www.jetir.org/papers/JETIR2305A52.pdf?utm_source=chatgpt.com)
